CollectWidget = function(_container,options){
  this.container = _container;
  this.options = options;
  this.widgetType = "CollectWidget";
  var _view = Backbone.View.extend({
    el:$(_container),
    initialize:function(){
      this.render();
    },
    render:function(){
      var template = _.template($("#collect_template").html(),{});
      this.el.html(template);
    },
    events:{
      "click #haokan_button":"haokanAction",
      "click #haoting_button":"haotingAction",
      "click #haochi_button":"haochiAction",
      "click #haowan_button":"haowanAction",
      "click #cool_button":"coolAction",
      "click #collect_button":"collectAction",
      "focus #text":"ClearAction",
      "blur #text":"AddAction"
    },

    haokanAction:function(evt){
      $("#tag").val($("#haokan_button").val());
    },

    haotingAction:function(evt){
      $("#tag").val( $("#haoting_button").val());
    },

     haochiAction:function(evt){
      $("#tag").val($("#haochi_button").val());
    },

     haowanAction:function(evt){
      $("#tag").val($("#haowan_button").val());
    },

     coolAction:function(evt){
      $("#tag").val($("#cool_button").val());
    },

    ClearAction:function(evt){
      var value = "说点什么吧~";
      if($("#text").val() == value){
	$("#text").val("");
      }
    },

    AddAction:function(evt){
      var value = "说点什么吧~";
      if($("#text").val() == ""){
	$("#text").val(value);
      }
    },


    collectAction:function(evt){
      var id = "1:1";
      var collect_url = client.URL.HOST_URL + client.SYMBOL.SLASH + client.URL.BASE_URL + "clip/"+id+"/reclip";
     var clip = {
       content: [],
       note: [
	 {text: "不包含content"}, // 用户有写文字备注，也有做语音备注
	 {sound: 125},
	 {sound: 167} // 数据结构支持一个摘录多条语音备注
       ],
       tag: ["cool","money","analycis"],
       source:{
	 type: "clipboard"
       },
       city: "beijing", // iphone 可以 GPS 获取城市
       device: "iphone/4.3"
     };
      var collect = $("#checkbox").attr("checked");
      var userInfo = new UserInfo(collect_url);
      var widget = this;
      userInfo.collectAction({
	clip:clip
      },
      {viewCallBack:function(status,infoText){
	 if(status == 0){
	   console.log("collect ok");
	   widget.el.html(infoText);
	   GlobalEvent.trigger(client.EVENTS.POPUP_CLOSE);
	 }else{
	   console.log("collect fail");
	 }
       }
      });
    }
});
  this.view = new _view();
};
CollectWidget.prototype.initialize = function(){
  this.view.initialize();
};

CollectWidget.prototype.render = function(){
  this.view.render();
};
